define(["jquery"],function(a){var h=60,j=0,f=null,k=function(){1>h?f.text("\u83b7\u53d6\u9a8c\u8bc1\u7801").removeAttr("disabled"):(f.attr("disabled",!0),f.text(h+" \u79d2\u540e\u91cd\u65b0\u83b7\u53d6"),h--,j=setTimeout(k,1E3))},i=null;return{mobCode:function(g,l){var b={trigger:a(g),api:l,parameter:null,onParameterError:null,onAPISuccess:null,onAPIError:null};"reset"==g?clearInterval(j):("function"!=typeof l&&(b=a.extend(b,l)),b.api||alert("funCodeRequest.mobCode  API not defined! "),b.trigger.each(function(){f=
a(this);1!=f.data("coderequest")&&(f.unbind("click").bind("click",function(){var e=a(this);f=e;if("disabled"!=e.attr("disabled")){var d=null;b.parameter&&"function"==typeof b.parameter?d=b.parameter():"string"==typeof b.parameter&&(d=b.parameter);if(!1===d){if(b.onParameterError)b.onParameterError()}else e.attr("disabled","disabled").text("\u77ed\u4fe1\u53d1\u9001\u4e2d..."),a(".help-inline",e.parent()).remove(),b.api(d,function(c){h=60;clearInterval(j);k();var d=c.message;c.data&&(d=c.data);c.data&&
c.data.msg&&(d=c.data.msg);a('<span class="help-inline">'+d+"</span>").insertAfter(e);if(b.onAPISuccess)b.onAPISuccess(c)},function(c){k();a('<span class="help-inline  mark" style="color:#b94a48">'+(c&&c.code?c.message:"\u53d1\u751f\u7cfb\u7edf\u9519\u8bef")+"</span>").insertAfter(e);if(b.onAPIError)b.onAPIError(c)})}}),a(this).data("coderequest",1))}))},unbindMobCode:function(g){a(g).each(function(){f=a(this);f.unbind("click")})},imgCode:function(g,f){var b=f||"/captcha";a(g).each(function(){if(1!=
a(this).data("coderequest")){var e=a(this),d=e.parent().children(".valcode");d&&0<d.length&&d.css({cursor:"pointer"}).click(function(){a("img",this).attr("src",b+"?nocache="+(new Date).getTime())});e.on("focusin",function(){if(i!==this){i=this;var c=e.parent().children(".valcode");c&&0<c.length?a("img",c).attr("src",b+"?nocache="+(new Date).getTime()):(c=a('<span class="valcode" style="cursor:pointer;width:180px"><img title="\u70b9\u51fb\u5237\u65b0\u9a8c\u8bc1\u7801" src="'+b+"?nocache="+(new Date).getTime()+
'" />\u770b\u4e0d\u6e05\uff1f<a>\u6362\u4e00\u5f20</a></span>'),c.click(function(){a("img",this).attr("src",b+"?nocache="+(new Date).getTime())}).insertAfter(e))}}).data("coderequest",1)}})},imgode4Ui:function(g,f){var b=f||"/captcha";a(g).each(function(){if(1!=a(this).data("coderequest")){var e=a(this),d=e.parents("ul").find(".valcode");d&&0<d.length&&d.css({cursor:"pointer"}).click(function(){a(this).find("img").attr("src",b+"?nocache="+(new Date).getTime())});e.on("focusin",function(){if(i!==this){i=
this;var c=e.parents("ul").find(".valcode");if(c&&0<c.length)a(c).find.attr("src",b+"?nocache="+(new Date).getTime());else{var d=e.parent(),f=a("<li class='valcode' style='cursor:pointer;'>");f.insertAfter(d);c=a('<img title="\u70b9\u51fb\u5237\u65b0\u9a8c\u8bc1\u7801" src="'+b+"?nocache="+(new Date).getTime()+'" />');c.click(function(){a(this).attr("src",b+"?nocache="+(new Date).getTime())}).appendTo(f);d=a("<li class='c5' style='cursor:pointer;'>");d.html("\u770b\u4e0d\u6e05\uff1f<a>\u6362\u4e00\u5f20</a>");
d.click(function(){c.attr("src",b+"?nocache="+(new Date).getTime())});d.insertAfter(f)}}}).data("coderequest",1)}})},imgCodes:function(f,h){var b=h||"/captcha";a(f).each(function(){if(1!=a(this).data("coderequest")){var e=a(this),d=e.parent().children(".valcode");d&&0<d.length&&d.css({cursor:"pointer"}).click(function(){a("img",this).attr("src",b+"?nocache="+(new Date).getTime())});e.on("focusin",function(){if(i!==this){i=this;var c=e.parent().children(".valcode");c&&0<c.length?a("img",c).attr("src",
b+"?nocache="+(new Date).getTime()):(c=a('<span class="valcode" style="cursor:pointer;width:120px;+width:125px;"><img title="\u70b9\u51fb\u5237\u65b0\u9a8c\u8bc1\u7801" src="'+b+"?nocache="+(new Date).getTime()+'" /><a class="icon-refresh rcaptcha" title="\u70b9\u51fb\u5237\u65b0\u9a8c\u8bc1\u7801" ></a></span>'),c.click(function(){a("img",this).attr("src",b+"?nocache="+(new Date).getTime())}).insertAfter(e))}}).data("coderequest",1)}})},clearCount:function(a){h=0;clearInterval(j);a.attr("disabled",
"disabled").text("\u53d1\u9001\u624b\u673a\u9a8c\u8bc1\u7801")}}});